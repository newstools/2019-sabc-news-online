Britain’s ambassador to Washington resigned Wednesday after being targeted by US President Donald Trump over the leak of highly critical diplomatic cables that put the allies’ relationship on edge. Outgoing Prime Minister Theresa May had offered her support to Kim Darroch after it was revealed he described the Trump administration as “inept”. But the man tipped to replace her in Downing Street this month, former foreign secretary Boris Johnson, declined to back the diplomat, instead emphasising the need to maintain strong ties with the US. In a series of confidential cables revealed by a British newspaper at the weekend, Darroch called the Trump administration “uniquely dysfunctional” and said the president was “radiating insecurity”. Trump hit back with a torrent of angry tweets, saying he would not deal with Darroch again, describing him as a “very stupid guy” and a “pompous fool”. He also criticised May’s “foolish” policies and said it was a good thing she would soon be replaced. Darroch has been in Washington since January 2016 and was due to stay until the end of the year. But in a statement he said: “The current situation is making it impossible for me to carry out my role as I would like.” Darroch has received support from across the political spectrum in Britain and after he resigned, Foreign Secretary Jeremy Hunt said: “It should never have come to this.” Hunt, who is vying with Johnson to replace May as leader of the ruling Conservative party and as prime minister, on Tuesday condemned Trump’s outbursts as “disrespectful and wrong”. But Johnson declined several opportunities in a TV debate Tuesday night to back Britain’s ambassador. “I don’t think it was necessarily the right thing for him to do,” he said of Trump’s tweets. “But our relationship with the US is of fantastic importance.” Reports suggest it was at this point that Darroch decided to resign. Yet Johnson himself has previously assailed the US president. As mayor of London in 2015, he said Trump was “out of his mind” for suggesting parts of the UK capital were “so radicalised” that even the police stayed away. “I think he is betraying a quite stupefying ignorance that makes him frankly unfit to hold the office of president of the United States,” Johnson said at the time. May expressed “great regret” that Darroch was leaving, saying: “Good government depends on public servants being able to give full and frank advice.” Tom Tugendhat, the Conservative chairman of parliament’s foreign affairs committee, warned the incident could have far-reaching implications. “If the UK can’t protect diplomatic communications and that costs people their careers… we will degrade the quality of our envoys, diminish our influence and weaken our country,” he said. Simon McDonald, the civil servant who heads Britain’s Diplomatic Service, said he had contacted all ambassadors “stressing that unvarnished, honest analysis is what we need”. “This is a personal tragedy for a friend and colleague,” he told Tugendhat’s committee, adding it would “make us look at our ways of working again.” Branding the leak “the worst breach of trust in our service” in his decades-spanning diplomatic career, he vowed to find the culprit “with all means at our disposal”. But McDonald said he was “braced” for the possibility of further unauthorised disclosures. “I fear there may be more,” he added. The British government has contacted police and launched its own investigation into the leak, which comes at a hugely sensitive time in US-UK relations. Trump was given the red-carpet treatment during a state visit to Britain last month, but there are tensions over his policies towards Iran and China. As Brexit looms, Britain is hoping for a free trade deal with the US to mitigate the impact of leaving the European Union. There has been speculation the leak was aimed at replacing Darroch with a more Brexit-friendly candidate. Trump has previously suggested the job should go to Nigel Farage, a British eurosceptic who recently founded the Brexit Party and — like Johnson — was prominent in the 2016 EU referendum campaign. However, British ambassadors are typically selected from the ranks of the diplomatic service and are rarely political appointments. On Twitter, Farage said Darroch had made “the right decision”, adding: “Time to put in a non-Remainer who wants a trade deal with America.”